SUBROUTINE ROOTWEIGHTMAX3(N,X,ROOTS,WEIGHTS)
        IMPLICIT NONE
        INTEGER, INTENT(IN) :: N
        DOUBLE PRECISION, INTENT(IN) :: X
        DOUBLE PRECISION, INTENT(OUT) :: ROOTS(25),WEIGHTS(25)
        DOUBLE PRECISION :: R12, PIE4, R22, W22, R13, R23, W23, R33, W33
        DOUBLE PRECISION :: RT1,RT2,RT3,WW1,WW2,WW3
        DOUBLE PRECISION :: F1,F2,E,T1,T2,T3,A1,A2,Y
        ROOTS(:) = 0.0d0
        WEIGHTS(:) = 0.0d0
        RT1=0.0d0
        RT2=0.0d0 
        RT3=0.0d0
        WW1=0.0d0
        WW2=0.0d0
        WW3=0.0d0
        R12 = 2.75255128608411E-01
        PIE4 = 7.85398163397448E-01
        R22 =  2.724744871391580d0
        W22 = 9.17517095361369E-02
        R13 = 1.90163509193487E-01
        R23 = 1.784492748543250d0
        W23 = 1.77231492083829E-01
        R33 = 5.525343742263260d0
        W33 = 5.11156880411248E-03
    
        IF (X .LT. 3.0E-07) THEN
                IF (n .EQ. 1) THEN
                        RT1 = 0.50d0 -X/5.0E+00
                        WW1 = 1.00d0 -X/3.0E+00
                ELSE IF (n .EQ. 2) THEN
                        RT1 = 1.30693606237085E-01 -2.90430236082028E-02*X
                        RT2 = 2.869306393762910d0 -6.37623643058102E-01*X
                        WW1 = 6.52145154862545E-01 -1.22713621927067E-01*X
                        WW2 = 3.47854845137453E-01 -2.10619711404725E-01*X
                ELSE IF (n .EQ. 3) THEN
                        RT1 = 6.03769246832797E-02 -9.28875764357368E-03*X
                        RT2 = 7.76823355931043E-01 -1.19511285527878E-01*X
                        RT3 = 6.662799719385670d0 -1.02504611068957E+00*X
                        WW1 = 4.67913934572691E-01 -5.64876917232519E-02*X
                        WW2 = 3.60761573048137E-01 -1.49077186455208E-01*X
                        WW3 = 1.71324492379169E-01 -1.27768455150979E-01*X
                ENDIF
        ELSE IF (X .LT. 1.0d0) THEN
                IF (n .EQ. 1) THEN
                        F1 = ((((((((-8.36313918003957E-08*X+1.21222603512827E-06 )*X-1.15662609053481E-05 )*X+9.25197374512647E-05 )*X-6.40994113129432E-04 )*X+3.78787044215009E-03 )*X- &
                        & 1.85185172458485E-02 )*X+7.14285713298222E-02 )*X- 1.99999999997023E-01 )*X+3.33333333333318E-01
                        WW1 = (X+X)*F1+exp(-X)
                        RT1 = F1/(WW1-F1)
                ELSE IF (n .EQ. 2) THEN
                        F1 = ((((((((-8.36313918003957E-08*X+1.21222603512827E-06 )*X- 1.15662609053481E-05 )*X+9.25197374512647E-05 )*X- 6.40994113129432E-04 )*X+3.78787044215009E-03 )*X- &
                        & 1.85185172458485E-02 )*X+7.14285713298222E-02 )*X- 1.99999999997023E-01 )*X+3.33333333333318E-01
                        WW1 = (X+X)*F1+exp(-X)
                        RT1 = (((((((-2.35234358048491E-09*X+2.49173650389842E-08)*X- 4.558315364581E-08)*X-2.447252174587E-06)*X+ 4.743292959463E-05)*X-5.33184749432408E-04 )*X+ &
                        & 4.44654947116579E-03 )*X-2.90430236084697E-02 )*X+ 1.30693606237085E-01
                        RT2 = (((((((-2.47404902329170E-08*X+2.36809910635906E-07)*X+ 1.835367736310E-06)*X-2.066168802076E-05)*X- 1.345693393936E-04)*X-5.88154362858038E-05 )*X+ &
                        & 5.32735082098139E-02 )*X-6.37623643056745E-01 )*X+ 2.869306393762890d0
                        WW2 = ((F1-WW1)*RT1+F1)*(1.00d0+RT2)/(RT2-RT1)
                        WW1 = WW1-WW2
                ELSE IF (n.EQ.3) THEN
                        RT1 = ((((((-5.10186691538870E-10*X+2.40134415703450E-08)*X- 5.01081057744427E-07 )*X+7.58291285499256E-06 )*X- 9.55085533670919E-05 )*X+1.02893039315878E-03 )*X- &
                        & 9.28875764374337E-03 )*X+6.03769246832810E-02
                        RT2 = ((((((-1.29646524960555E-08*X+7.74602292865683E-08)*X+ 1.56022811158727E-06 )*X-1.58051990661661E-05 )*X- 3.30447806384059E-04 )*X+9.74266885190267E-03 )*X- &
                        & 1.19511285526388E-01 )*X+7.76823355931033E-01
                        RT3 = ((((((-9.28536484109606E-09*X-3.02786290067014E-07)*X- 2.50734477064200E-06 )*X-7.32728109752881E-06 )*X+ 2.44217481700129E-04 )*X+4.94758452357327E-02 )*X- &
                        & 1.025046110657740d0 )*X+6.66279971938553E+00
                        F2 = ((((((((-7.60911486098850E-08*X+1.09552870123182E-06 )*X- 1.03463270693454E-05 )*X+8.16324851790106E-05 )*X- 5.55526624875562E-04 )*X+3.20512054753924E-03 )*X- &
                        & 1.51515139838540E-02 )*X+5.55555554649585E-02 )*X- 1.42857142854412E-01 )*X+1.99999999999986E-01
                        E = exp(-X)
                        F1 = ((X+X)*F2+E)/3.00d0
                        WW1 = (X+X)*F1+E
                        T1 = RT1/(RT1+1.00d0)
                        T2 = RT2/(RT2+1.00d0)
                        T3 = RT3/(RT3+1.00d0)
                        A2 = F2-T1*F1
                        A1 = F1-T1*WW1
                        WW3 = (A2-T2*A1)/((T3-T2)*(T3-T1))
                        WW2 = (T3*A1-A2)/((T3-T2)*(T2-T1))
                        WW1 = WW1-WW2-WW3
                ENDIF
        ELSE IF (X .LT. 3.0d0) THEN
                Y = X-2.00d0
                IF (n .EQ. 1) THEN
                        F1 = ((((((((((-1.61702782425558E-10*Y+1.96215250865776E-09 )*Y- 2.14234468198419E-08 )*Y+2.17216556336318E-07 )*Y- 1.98850171329371E-06 )*Y+1.62429321438911E-05 )*Y- &
                        & 1.16740298039895E-04 )*Y+7.24888732052332E-04 )*Y- 3.79490003707156E-03 )*Y+1.61723488664661E-02 )*Y- 5.29428148329736E-02 )*Y+1.15702180856167E-01
                        WW1 = (X+X)*F1+exp(-X)
                        RT1 = F1/(WW1-F1)
                ELSE IF (n .EQ. 2) THEN
                        F1 = ((((((((((-1.61702782425558E-10*Y+1.96215250865776E-09 )*Y- 2.14234468198419E-08 )*Y+2.17216556336318E-07 )*Y- 1.98850171329371E-06 )*Y+1.62429321438911E-05 )*Y- &
                        & 1.16740298039895E-04 )*Y+7.24888732052332E-04 )*Y- 3.79490003707156E-03 )*Y+1.61723488664661E-02 )*Y- 5.29428148329736E-02 )*Y+1.15702180856167E-01
                        WW1 = (X+X)*F1+exp(-X)
                        RT1 = (((((((((-6.36859636616415E-12*Y+8.47417064776270E-11)*Y- 5.152207846962E-10)*Y-3.846389873308E-10)*Y+ 8.472253388380E-08)*Y-1.85306035634293E-06 )*Y+ &
                        & 2.47191693238413E-05 )*Y-2.49018321709815E-04 )*Y+ 2.19173220020161E-03 )*Y-1.63329339286794E-02 )*Y+ 8.68085688285261E-02
                        RT2 = ((((((((( 1.45331350488343E-10*Y+2.07111465297976E-09)*Y- 1.878920917404E-08)*Y-1.725838516261E-07)*Y+ 2.247389642339E-06)*Y+9.76783813082564E-06 )*Y- &
                        & 1.93160765581969E-04 )*Y-1.58064140671893E-03 )*Y+ 4.85928174507904E-02 )*Y-4.30761584997596E-01 )*Y+ 1.804009745379500d0
                        WW2 = ((F1-WW1)*RT1+F1)*(1.00d0+RT2)/(RT2-RT1)
                        WW1 = WW1-WW2
                ELSE IF (n .EQ. 3) THEN
                        RT1 = (((((((( 1.44687969563318E-12*Y+4.85300143926755E-12)*Y- 6.55098264095516E-10 )*Y+1.56592951656828E-08 )*Y- 2.60122498274734E-07 )*Y+3.86118485517386E-06 )*Y- &
                        & 5.13430986707889E-05 )*Y+6.03194524398109E-04 )*Y- 6.11219349825090E-03 )*Y+4.52578254679079E-02
                        RT2 = ((((((( 6.95964248788138E-10*Y-5.35281831445517E-09)*Y- 6.745205954533E-08)*Y+1.502366784525E-06)*Y+ 9.923326947376E-07)*Y-3.89147469249594E-04 )*Y+ &
                        & 7.51549330892401E-03 )*Y-8.48778120363400E-02 )*Y+ 5.73928229597613E-01
                        RT3 = ((((((((-2.81496588401439E-10*Y+3.61058041895031E-09)*Y+ 4.53631789436255E-08 )*Y-1.40971837780847E-07 )*Y- 6.05865557561067E-06 )*Y-5.15964042227127E-05 )*Y+ &
                        & 3.34761560498171E-05 )*Y+5.04871005319119E-02 )*Y- 8.24708946991557E-01 )*Y+4.812346673572050d0
                        F2 = ((((((((((-1.48044231072140E-10*Y+1.78157031325097E-09 )*Y- 1.92514145088973E-08 )*Y+1.92804632038796E-07 )*Y- 1.73806555021045E-06 )*Y+1.39195169625425E-05 )*Y- &
                        & 9.74574633246452E-05 )*Y+5.83701488646511E-04 )*Y- 2.89955494844975E-03 )*Y+1.13847001113810E-02 )*Y- 3.23446977320647E-02 )*Y+5.29428148329709E-02
                        E = exp(-X)
                        F1 = ((X+X)*F2+E)/3.00d0
                        WW1 = (X+X)*F1+E
                        T1 = RT1/(RT1+1.00d0)
                        T2 = RT2/(RT2+1.00d0)
                        T3 = RT3/(RT3+1.00d0)
                        A2 = F2-T1*F1
                        A1 = F1-T1*WW1
                        WW3 = (A2-T2*A1)/((T3-T2)*(T3-T1))
                        WW2 = (T3*A1-A2)/((T3-T2)*(T2-T1))
                        WW1 = WW1-WW2-WW3
                ENDIF
        ELSE IF (X .LT. 5.0d0) THEN
                Y = X-4.00d0
                IF (n .EQ. 1) THEN
                        F1 = ((((((((((-2.62453564772299E-11*Y+3.24031041623823E-10 )*Y- 3.614965656163E-09)*Y+3.760256799971E-08)*Y- 3.553558319675E-07)*Y+3.022556449731E-06)*Y- &
                        & 2.290098979647E-05)*Y+1.526537461148E-04)*Y- 8.81947375894379E-04 )*Y+4.33207949514611E-03 )*Y- 1.75257821619926E-02 )*Y+5.28406320615584E-02
                        WW1 = (X+X)*F1+exp(-X)
                        RT1 = F1/(WW1-F1)
                ELSE IF (n .EQ. 2) THEN
                        F1 = ((((((((((-2.62453564772299E-11*Y+3.24031041623823E-10 )*Y- 3.614965656163E-09)*Y+3.760256799971E-08)*Y- 3.553558319675E-07)*Y+3.022556449731E-06)*Y- &
                        & 2.290098979647E-05)*Y+1.526537461148E-04)*Y- 8.81947375894379E-04 )*Y+4.33207949514611E-03 )*Y- 1.75257821619926E-02 )*Y+5.28406320615584E-02
                        WW1 = (X+X)*F1+exp(-X)
                        RT1 = ((((((((-4.11560117487296E-12*Y+7.10910223886747E-11)*Y- 1.73508862390291E-09 )*Y+5.93066856324744E-08 )*Y- 9.76085576741771E-07 )*Y+1.08484384385679E-05 )*Y- &
                        & 1.12608004981982E-04 )*Y+1.16210907653515E-03 )*Y- 9.89572595720351E-03 )*Y+6.12589701086408E-02
                        RT2 = (((((((((-1.80555625241001E-10*Y+5.44072475994123E-10)*Y+ 1.603498045240E-08)*Y-1.497986283037E-07)*Y- 7.017002532106E-07)*Y+1.85882653064034E-05 )*Y- &
                        & 2.04685420150802E-05 )*Y-2.49327728643089E-03 )*Y+ 3.56550690684281E-02 )*Y-2.60417417692375E-01 )*Y+ 1.121552831082890d0
                        WW2 = ((F1-WW1)*RT1+F1)*(1.00d0+RT2)/(RT2-RT1)
                        WW1 = WW1-WW2
                ELSE IF (n .EQ. 3) THEN
                        RT1 = ((((((( 1.44265709189601E-11*Y-4.66622033006074E-10)*Y+ 7.649155832025E-09)*Y-1.229940017368E-07)*Y+ 2.026002142457E-06)*Y-2.87048671521677E-05 )*Y+ &
                        & 3.70326938096287E-04 )*Y-4.21006346373634E-03 )*Y+ 3.50898470729044E-02
                        RT2 = ((((((((-2.65526039155651E-11*Y+1.97549041402552E-10)*Y+ 2.15971131403034E-09 )*Y-7.95045680685193E-08 )*Y+ 5.15021914287057E-07 )*Y+1.11788717230514E-05 )*Y- &
                        & 3.33739312603632E-04 )*Y+5.30601428208358E-03 )*Y- 5.93483267268959E-02 )*Y+4.31180523260239E-01
                        RT3 = ((((((((-3.92833750584041E-10*Y-4.16423229782280E-09)*Y+ 4.42413039572867E-08 )*Y+6.40574545989551E-07 )*Y- 3.05512456576552E-06 )*Y-1.05296443527943E-04 )*Y- &
                        & 6.14120969315617E-04 )*Y+4.89665802767005E-02 )*Y- 6.24498381002855E-01 )*Y+3.364123122437240d0
                        F2 = ((((((((((-2.36788772599074E-11*Y+2.89147476459092E-10 )*Y- 3.18111322308846E-09 )*Y+3.25336816562485E-08 )*Y- 3.00873821471489E-07 )*Y+2.48749160874431E-06 )*Y- &
                        & 1.81353179793672E-05 )*Y+1.14504948737066E-04 )*Y- 6.10614987696677E-04 )*Y+2.64584212770942E-03 )*Y- 8.66415899015349E-03 )*Y+1.75257821619922E-02
                        E = exp(-X)
                        F1 = ((X+X)*F2+E)/3.00d0
                        WW1 = (X+X)*F1+E
                        T1 = RT1/(RT1+1.00d0)
                        T2 = RT2/(RT2+1.00d0)
                        T3 = RT3/(RT3+1.00d0)
                        A2 = F2-T1*F1
                        A1 = F1-T1*WW1
                        WW3 = (A2-T2*A1)/((T3-T2)*(T3-T1))
                        WW2 = (T3*A1-A2)/((T3-T2)*(T2-T1))
                        WW1 = WW1-WW2-WW3
                ENDIF
        ELSE IF (X .LT. 10.0d0 ) THEN
                E = exp(-X)
                WW1 = (((((( 4.6897511375022E-01/X-6.9955602298985E-01)/X + 5.3689283271887E-01)/X-3.2883030418398E-01)/X + 2.4645596956002E-01)/X-4.9984072848436E-01)/X - &
                & 3.1501078774085E-06)*E + sqrt(PIE4/X)
                F1 = (WW1-E)/(X+X)
                IF (n .EQ. 1) THEN
                RT1 = F1/(WW1-F1)
                ELSE IF (n .EQ. 2) THEN
                        Y = X-7.50d0
                        RT1 = (((((((((((((-1.43632730148572E-16*Y+2.38198922570405E-16)*Y+1.358319618800E-14)*Y-7.064522786879E-14)*Y- 7.719300212748E-13)*Y+7.802544789997E-12)*Y+ &
                        & 6.628721099436E-11)*Y-1.775564159743E-09)*Y+ 1.713828823990E-08)*Y-1.497500187053E-07)*Y+ 2.283485114279E-06)*Y-3.76953869614706E-05 )*Y+ &
                        & 4.74791204651451E-04 )*Y-4.60448960876139E-03 )*Y+ 3.72458587837249E-02
                        RT2 = (((((((((((( 2.48791622798900E-14*Y-1.36113510175724E-13)*Y- 2.224334349799E-12)*Y+4.190559455515E-11)*Y- 2.222722579924E-10)*Y-2.624183464275E-09)*Y+ &
                        & 6.128153450169E-08)*Y-4.383376014528E-07)*Y- 2.49952200232910E-06 )*Y+1.03236647888320E-04 )*Y- 1.44614664924989E-03 )*Y+1.35094294917224E-02 )*Y- &
                        & 9.53478510453887E-02 )*Y+5.44765245686790E-01
                        WW2 = ((F1-WW1)*RT1+F1)*(1.00d0+RT2)/(RT2-RT1)
                        WW1 = WW1-WW2
                ELSE IF (n .EQ. 3) THEN
                        F2 = (F1+F1+F1-E)/(X+X)
                        Y = X-7.50d0
                        RT1 = ((((((((((( 5.74429401360115E-16*Y+7.11884203790984E-16)*Y- 6.736701449826E-14)*Y-6.264613873998E-13)*Y+ 1.315418927040E-11)*Y-4.23879635610964E-11 )*Y+ &
                        & 1.39032379769474E-09 )*Y-4.65449552856856E-08 )*Y+ 7.34609900170759E-07 )*Y-1.08656008854077E-05 )*Y+ 1.77930381549953E-04 )*Y-2.39864911618015E-03 )*Y+ &
                        & 2.39112249488821E-02
                        RT2 = ((((((((((( 1.13464096209120E-14*Y+6.99375313934242E-15)*Y- 8.595618132088E-13)*Y-5.293620408757E-12)*Y- 2.492175211635E-11)*Y+2.73681574882729E-09 )*Y- &
                        & 1.06656985608482E-08 )*Y-4.40252529648056E-07 )*Y+ 9.68100917793911E-06 )*Y-1.68211091755327E-04 )*Y+ 2.69443611274173E-03 )*Y-3.23845035189063E-02 )*Y+ &
                        & 2.75969447451882E-01
                        RT3 = (((((((((((( 6.66339416996191E-15*Y+1.84955640200794E-13)*Y- 1.985141104444E-12)*Y-2.309293727603E-11)*Y+ 3.917984522103E-10)*Y+1.663165279876E-09)*Y- &
                        & 6.205591993923E-08)*Y+8.769581622041E-09)*Y+ 8.97224398620038E-06 )*Y-3.14232666170796E-05 )*Y- 1.83917335649633E-03 )*Y+3.51246831672571E-02 )*Y- &
                        & 3.22335051270860E-01 )*Y+1.735828317554300d0
                        T1 = RT1/(RT1+1.00d0)
                        T2 = RT2/(RT2+1.00d0)
                        T3 = RT3/(RT3+1.00d0)
                        A2 = F2-T1*F1
                        A1 = F1-T1*WW1
                        WW3 = (A2-T2*A1)/((T3-T2)*(T3-T1))
                        WW2 = (T3*A1-A2)/((T3-T2)*(T2-T1))
                        WW1 = WW1-WW2-WW3
                ENDIF
        ELSE IF (X .LT. 15.0d0 ) THEN
                E = exp(-X)
                WW1 = (((-1.8784686463512E-01/X+2.2991849164985E-01)/X - 4.9893752514047E-01)/X-2.1916512131607E-05)*E  + sqrt(PIE4/X)
                F1 = (WW1-E)/(X+X)
                IF (n .EQ. 1) THEN
                        RT1 = F1/(WW1-F1)
                ELSE IF (n .EQ. 2) THEN
                        RT1 = ((((-1.01041157064226E-05*X+1.19483054115173E-03)*X - 6.73760231824074E-02)*X+1.257055710698950d0)*X + (((-8.57609422987199E+03/X+5.91005939591842E+03)/X - &
                        & 1.70807677109425E+03)/X+2.64536689959503E+02)/X - 2.38570496490846E+01)*E + R12/(X-R12)
                        RT2 = ((( 3.39024225137123E-04*X-9.34976436343509E-02)*X - 4.222164833063200d0)*X + (((-2.08457050986847E+03/X - 1.04999071905664E+03)/X+3.39891508992661E+02)/X - &
                        & 1.56184800325063E+02)/X+8.008390332975010d0)*E + R22/(X-R22)
                        WW2 = ((F1-WW1)*RT1+F1)*(1.00d0+RT2)/(RT2-RT1)
                        WW1 = WW1-WW2
                ELSE IF (n .EQ. 3) THEN
                        F2 = (F1+F1+F1-E)/(X+X)
                        Y = X-12.50d0
                        RT1 = ((((((((((( 4.42133001283090E-16*Y-2.77189767070441E-15)*Y- 4.084026087887E-14)*Y+5.379885121517E-13)*Y+ 1.882093066702E-12)*Y-8.67286219861085E-11 )*Y+ &
                        & 7.11372337079797E-10 )*Y-3.55578027040563E-09 )*Y+ 1.29454702851936E-07 )*Y-4.14222202791434E-06 )*Y+ 8.04427643593792E-05 )*Y-1.18587782909876E-03 )*Y+ &
                        & 1.53435577063174E-02
                        RT2 = ((((((((((( 6.85146742119357E-15*Y-1.08257654410279E-14)*Y- 8.579165965128E-13)*Y+6.642452485783E-12)*Y+ 4.798806828724E-11)*Y-1.13413908163831E-09 )*Y+ &
                        & 7.08558457182751E-09 )*Y-5.59678576054633E-08 )*Y+ 2.51020389884249E-06 )*Y-6.63678914608681E-05 )*Y+ 1.11888323089714E-03 )*Y-1.45361636398178E-02 )*Y+ &
                        & 1.65077877454402E-01
                        RT3 = (((((((((((( 3.20622388697743E-15*Y-2.73458804864628E-14)*Y- 3.157134329361E-13)*Y+8.654129268056E-12)*Y- 5.625235879301E-11)*Y-7.718080513708E-10)*Y+ &
                        & 2.064664199164E-08)*Y-1.567725007761E-07)*Y- 1.57938204115055E-06 )*Y+6.27436306915967E-05 )*Y- 1.01308723606946E-03 )*Y+1.13901881430697E-02 )*Y- &
                        & 1.01449652899450E-01 )*Y+7.77203937334739E-01
                        T1 = RT1/(RT1+1.00d0)
                        T2 = RT2/(RT2+1.00d0)
                        T3 = RT3/(RT3+1.00d0)
                        A2 = F2-T1*F1
                        A1 = F1-T1*WW1
                        WW3 = (A2-T2*A1)/((T3-T2)*(T3-T1))
                        WW2 = (T3*A1-A2)/((T3-T2)*(T2-T1))
                        WW1 = WW1-WW2-WW3
                ENDIF
        ELSE IF (X .LT. 33.0d0 ) THEN
                E = exp(-X)
                WW1 = (( 1.9623264149430E-01/X-4.9695241464490E-01)/X - 6.0156581186481E-05)*E + sqrt(PIE4/X)
                F1 = (WW1-E)/(X+X)
                IF (n .EQ. 1) THEN
                        RT1 = F1/(WW1-F1)
                ELSE IF (n .EQ. 2) THEN
                        RT1 = ((((-1.14906395546354E-06*X+1.76003409708332E-04)*X - 1.71984023644904E-02)*X-1.37292644149838E-01)*X + (-4.75742064274859E+01/X+9.210051865428570d0)/X - &
                        & 2.31080873898939E-02)*E + R12/(X-R12)
                        RT2 = ((( 3.64921633404158E-04*X-9.71850973831558E-02)*X - 4.028861748502520d0)*X + (-1.35831002139173E+02/X - 8.66891724287962E+01)/X+2.98011277766958E+00)*E + R22/(X-R22)
                        WW2 = ((F1-WW1)*RT1+F1)*(1.00d0+RT2)/(RT2-RT1)
                        WW1 = WW1-WW2
                ELSE IF (n .EQ. 3) THEN
                        F2 = (F1+F1+F1-E)/(X+X)
                        IF (X .LT. 20.0d0 ) THEN
                                RT1 = ((((((-2.43270989903742E-06*X+3.57901398988359E-04)*X - 2.34112415981143E-02)*X+7.81425144913975E-01)*X - 1.73209218219175E+01)*X+2.43517435690398E+02)*X + &
                                & (-1.97611541576986E+04/X+9.82441363463929E+03)/X - 2.07970687843258E+03)*E + R13/(X-R13)
                                RT2 = (((((-2.62627010965435E-04*X+3.49187925428138E-02)*X - 3.093376187318800d0)*X+1.07037141010778E+02)*X - 2.36659637247087E+03)*X + ((-2.91669113681020E+06/X + &
                                & 1.41129505262758E+06)/X-2.91532335433779E+05)/X + 3.35202872835409E+04)*E + R23/(X-R23)
                                RT3 = ((((( 9.31856404738601E-05*X-2.87029400759565E-02)*X - 7.83503697918455E-01)*X-1.84338896480695E+01)*X + 4.04996712650414E+02)*X + (-1.89829509315154E+05/X + &
                                & 5.11498390849158E+04)/X-6.88145821789955E+03)*E  + R33/(X-R33)
                        ELSE 
                                RT1 = ((((-4.97561537069643E-04*X-5.00929599665316E-02)*X + 1.310991422389960d0)*X-1.88336409225481E+01)*X - 6.60344754467191E+02 /X+1.64931462413877E+02)*E &
                                &  + R13/(X-R13)
                                RT2 = ((((-4.48218898474906E-03*X-5.17373211334924E-01)*X + 1.13691058739678E+01)*X-1.65426392885291E+02)*X - 6.30909125686731E+03 /X+1.52231757709236E+03)*E & 
                                &  + R23/(X-R23)
                                RT3 = ((((-1.38368602394293E-02*X-1.772934288630080d0)*X + 1.73639054044562E+01)*X-3.57615122086961E+02)*X - 1.45734701095912E+04 /X+2.69831813951849E+03)*E & 
                                &  + R33/(X-R33)
                        ENDIF
                        T1 = RT1/(RT1+1.00d0)
                        T2 = RT2/(RT2+1.00d0)
                        T3 = RT3/(RT3+1.00d0)
                        A2 = F2-T1*F1
                        A1 = F1-T1*WW1
                        WW3 = (A2-T2*A1)/((T3-T2)*(T3-T1))
                        WW2 = (T3*A1-A2)/((T3-T2)*(T2-T1))
                        WW1 = WW1-WW2-WW3
                ENDIF
        ELSE 
                WW1 = sqrt(PIE4/X)
                IF (n .EQ. 1) THEN
                        RT1 = 0.50d0/(X-0.5d0)
                ELSE IF (n .EQ. 2) THEN
                        IF (X .LT. 40.0d0) THEN
                                E = exp(-X)
                                RT1 = (-8.78947307498880E-01*X+1.09243702330261E+01)*E  + R12/(X-R12)
                                RT2 = (-9.289039242759770d0*X+8.10642367843811E+01)*E  + R22/(X-R22)
                                WW2 = ( 4.468573893084000d0*X-7.79250653461045E+01)*E + W22*WW1
                                WW1 = WW1-WW2
                         ELSE 
                                RT1 = R12/(X-R12)
                                RT2 = R22/(X-R22)
                                WW2 = W22*WW1
                                WW1 = WW1-WW2
                        ENDIF
                ELSE IF (n .EQ. 3) THEN
                        IF (X .LT. 47.0d0) THEN
                                E = exp(-X)
                                RT1 = ((-7.390584679952750d0*X+3.21318352526305E+02)*X - 3.99433696473658E+03)*E + R13/(X-R13)
                                RT2 = ((-7.38726243906513E+01*X+3.13569966333873E+03)*X - 3.86862867311321E+04)*E + R23/(X-R23)
                                RT3 = ((-2.63750565461336E+02*X+1.04412168692352E+04)*X - 1.28094577915394E+05)*E + R33/(X-R33)
                                WW3 = ((( 1.52258947224714E-01*X-8.306619000426510d0)*X + 1.92977367967984E+02)*X-1.67787926005344E+03)*E  + W33*WW1
                                WW2 = (( 6.15072615497811E+01*X-2.91980647450269E+03)*X + 3.80794303087338E+04)*E + W23*WW1
                                WW1 = WW1-WW2-WW3
                        ELSE 
                                RT1 = R13/(X-R13)
                                RT2 = R23/(X-R23)
                                RT3 = R33/(X-R33)
                                WW2 = W23*WW1
                                WW3 = W33*WW1
                                WW1 = WW1-WW2-WW3
                        ENDIF
                ENDIF
        ENDIF
        ROOTS(1) = RT1
        WEIGHTS(1) = WW1
        IF (n .GT. 1) THEN
                ROOTS(2) = RT2
                WEIGHTS(2) = WW2
        ENDIF
        IF (n .GT. 2) THEN
                ROOTS(3) = RT3
                WEIGHTS(3) = WW3
        ENDIF
END SUBROUTINE ROOTWEIGHTMAX3
